"0","#| label: lipinski-functions"
"0",""
"0","# Calculate Lipinski descriptors using rcdk"
"0","calculate_lipinski_descriptors <- function(smiles_vector) {"
"0","  cli::cli_h2(""Calculating Lipinski Descriptors (serial mode)"")"
"0",""
"0","  # Parse SMILES"
"0","  cli::cli_alert_info(""Parsing SMILES structures..."")"
"0",""
"0","  molecules <- purrr::map(smiles_vector, function(smi) {"
"0","    tryCatch({"
"0","      parse.smiles(smi)[[1]]"
"0","    }, error = function(e) NULL)"
"0","  })"
"0",""
"0","  # Set up a progress bar"
"0","  total <- length(molecules)"
"0","  pb <- txtProgressBar(min = 0, max = total, style = 3)"
"0",""
"0","  # Calculate descriptors serially"
"0","  lipinski_data <- purrr::map_dfr(seq_along(molecules), function(i) {"
"0","    setTxtProgressBar(pb, i)"
"0","    mol <- molecules[[i]]"
"0","    if (is.null(mol)) {"
"0","      return(data.frame("
"0","        idx = i,"
"0","        MW = NA, LogP = NA, HBD = NA, HBA = NA,"
"0","        TPSA = NA, nRotB = NA, nAtoms = NA"
"0","      ))"
"0","    }"
"0","    tryCatch({"
"0","      mw <- get.mol2formula(mol)@mass"
"0","      logP <- eval.desc(mol, ""org.openscience.cdk.qsar.descriptors.molecular.XLogPDescriptor"")[[1]]"
"0","      hbd <- eval.desc(mol, ""org.openscience.cdk.qsar.descriptors.molecular.HBondDonorCountDescriptor"")[[1]]"
"0","      hba <- eval.desc(mol, ""org.openscience.cdk.qsar.descriptors.molecular.HBondAcceptorCountDescriptor"")[[1]]"
"0","      tpsa <- eval.desc(mol, ""org.openscience.cdk.qsar.descriptors.molecular.TPSADescriptor"")[[1]]"
"0","      nrotb <- eval.desc(mol, ""org.openscience.cdk.qsar.descriptors.molecular.RotatableBondsCountDescriptor"")[[1]]"
"0","      natoms <- get.atom.count(mol)"
"0","      data.frame("
"0","        idx = i,"
"0","        MW = mw,"
"0","        LogP = logP,"
"0","        HBD = hbd,"
"0","        HBA = hba,"
"0","        TPSA = tpsa,"
"0","        nRotB = nrotb,"
"0","        nAtoms = natoms"
"0","      )"
"0","    }, error = function(e) {"
"0","      data.frame("
"0","        idx = i,"
"0","        MW = NA, LogP = NA, HBD = NA, HBA = NA,"
"0","        TPSA = NA, nRotB = NA, nAtoms = NA"
"0","      )"
"0","    })"
"0","  })"
"0","  close(pb)"
"0","  cli::cli_alert_success(""Descriptor calculation complete!"")"
"0","  return(lipinski_data)"
"0","}"
"0",""
"0","cat(cli::col_green(""âœ“ Lipinski descriptor functions defined!\n""))"
"1","[32mâœ“ Lipinski descriptor functions defined!
[39m"
